language: generic

os:
  - linux
  - osx

sudo: required
dist: trusty
osx_image: xcode8.2

addons:
  apt:
    packages:
      - texinfo

env:
  - ANDROID_PLATFORM=arm
  - ANDROID_PLATFORM=arm64
  - ANDROID_PLATFORM=mips
  - ANDROID_PLATFORM=mips64
  - ANDROID_PLATFORM=x86
  - ANDROID_PLATFORM=x86_64

install:
  - cat travis/hgrc >> ~/.hgrc
  - source ./travis/install-python-nightly.sh
  - |
      pushd $HOME
      HOST_OS="$(uname | tr 'A-Z' 'a-z')"
      wget https://dl.google.com/android/repository/android-ndk-r14-beta1-$HOST_OS-x86_64.zip
      unzip -q android-ndk-r14-beta1-$HOST_OS-x86_64.zip
      popd
  - export ANDROID_NDK=$HOME/android-ndk-r14-beta1

script:
  - make
  - make test
